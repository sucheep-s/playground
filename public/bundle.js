var myApp=angular.module("myApp",["ui.router","myApp.templates","ui.bootstrap","angularFileUpload","ui.calendar","uiGmapgoogle-maps"]);myApp.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/homepage"),$stateProvider.state("homepage",{url:"/homepage",templateUrl:"views/homepage.html",controller:"UserController"}).state("users",{url:"/users",templateUrl:"views/userlist.html",controller:"UserController"}).state("adduser",{url:"/adduser",templateUrl:"views/adduser.html",controller:"UserController"}).state("calendar",{url:"/calendar",templateUrl:"views/calendar.html",controller:"CalendarController"}).state("file",{url:"/file",templateUrl:"views/file.html",controller:"FileController"}).state("map",{url:"/map",templateUrl:"views/map.html",controller:"MapController"})}]),myApp.config(function(uiGmapGoogleMapApiProvider){uiGmapGoogleMapApiProvider.configure({key:"AIzaSyCrTln0RisVqMas-3I7O5djpc6gsPqItOg",v:"3.20",libraries:"weather,geometry,visualization"})}),myApp.factory("FileService",function($http){var factory={};return factory}),myApp.factory("UserService",function($http){var factory={},urlBase="http://192.168.1.38/buswifi/rest/userapi";return factory.getUsers=function(){return $http.get(urlBase+"/getusers?sort=createDate&order=desc&max=10&page=1")},factory.getUser=function(id){return $http.get(urlBase)},factory.addUser=function(user){return $http.post(urlBase,user)},factory}),myApp.controller("CalendarController",["$scope",function($scope){var date=new Date,d=date.getDate(),m=date.getMonth(),y=date.getFullYear();$scope.eventSource={url:"http://www.google.com/calendar/feeds/usa__en%40holiday.calendar.google.com/public/basic",className:"gcal-event",currentTimezone:"America/Chicago"},$scope.events=[{title:"All Day Event",start:new Date(y,m,1)},{title:"Long Event",start:new Date(y,m,d-5),end:new Date(y,m,d-2)},{id:999,title:"Repeating Event",start:new Date(y,m,d-3,16,0),allDay:!1},{id:999,title:"Repeating Event",start:new Date(y,m,d+4,16,0),allDay:!1},{title:"Birthday Party",start:new Date(y,m,d+1,19,0),end:new Date(y,m,d+1,22,30),allDay:!1},{title:"Click for Google",start:new Date(y,m,28),end:new Date(y,m,29),url:"http://google.com/"}],$scope.goToRootScopeDate=function(date,jsEvent,view){alert(date)},$scope.loading=function(isLoading,view){alert("is loading"+isLoading)},$scope.uiConfig={calendar:{height:450,editable:!0,header:{left:"title",center:"",right:"today prev,next"},loading:$scope.loading,dayClick:$scope.goToRootScopeDate,eventClick:$scope.alertOnEventClick,eventDrop:$scope.alertOnDrop,eventResize:$scope.alertOnResize,defaultView:"month"}},$scope.eventSources=[$scope.events,$scope.eventSource]}]),myApp.controller("FileController",function($scope,$location,FileUploader,FileService){$scope.uploader=new FileUploader}),myApp.controller("MapController",function($scope,$location,$log){$scope.map={center:{latitude:13.742906,longitude:100.548891},zoom:16,bounds:{}},$scope.markers=[{id:0,coords:{latitude:13.742716,longitude:100.547852},options:{draggable:!0,icon:"/assets/images/icon.png"}},{id:1,coords:{latitude:13.743396,longitude:100.546059},options:{draggable:!0,icon:"/assets/images/icon.png"}},{id:2,coords:{latitude:13.742897,longitude:100.551003},options:{draggable:!0,icon:"/assets/images/icon.png"}}]}),myApp.controller("UserController",function($scope,$location,UserService){function getUsers(){UserService.getUsers().success(function(data){$scope.users=data.userList}).error(function(error){})}$scope.init=function(){getUsers()},$scope.addUser=function(){var user={mobileNo:$scope.mobileNo,dateOfBirth:$scope.dateOfBirth,gender:$scope.gender,createDate:$scope.createDate};UserService.addUser(user).success(function(){$location.path("/users")})},$scope.navbarCollapse=!1}),angular.module("ui.calendar",[]).constant("uiCalendarConfig",{calendars:{}}).controller("uiCalendarCtrl",["$scope","$locale",function($scope,$locale){var sources=$scope.eventSources,extraEventSignature=$scope.calendarWatchEvent?$scope.calendarWatchEvent:angular.noop,wrapFunctionWithScopeApply=function(functionToWrap){return function(){if($scope.$root.$$phase)return functionToWrap.apply(this,arguments);var args=arguments,self=this;return $scope.$root.$apply(function(){return functionToWrap.apply(self,args)})}},eventSerialId=1;this.eventFingerprint=function(e){e._id||(e._id=eventSerialId++);var extraSignature=extraEventSignature({event:e})||"",start=moment.isMoment(e.start)?e.start.unix():e.start?moment(e.start).unix():"",end=moment.isMoment(e.end)?e.end.unix():e.end?moment(e.end).unix():"";return""+e._id+(e.id||"")+(e.title||"")+(e.url||"")+start+end+(e.allDay||"")+(e.className||"")+extraSignature};var sourceSerialId=1,sourceEventsSerialId=1;this.sourceFingerprint=function(source){var fp=""+(source.__id||(source.__id=sourceSerialId++)),events=angular.isObject(source)&&source.events;return events&&(fp=fp+"-"+(events.__id||(events.__id=sourceEventsSerialId++))),fp},this.allEvents=function(){for(var arraySources=[],i=0,srcLen=sources.length;srcLen>i;i++){var source=sources[i];if(angular.isArray(source))arraySources.push(source);else if(angular.isObject(source)&&angular.isArray(source.events)){var extEvent={};for(var key in source)"_id"!==key&&"events"!==key&&(extEvent[key]=source[key]);for(var eI=0;eI<source.events.length;eI++)angular.extend(source.events[eI],extEvent);arraySources.push(source.events)}}return Array.prototype.concat.apply([],arraySources)},this.changeWatcher=function(arraySource,tokenFn){var self,getTokens=function(){for(var token,el,array=angular.isFunction(arraySource)?arraySource():arraySource,result=[],i=0,n=array.length;n>i;i++)el=array[i],token=tokenFn(el),map[token]=el,result.push(token);return result},subtractAsSets=function(a,b){var i,n,result=[],inB={};for(i=0,n=b.length;n>i;i++)inB[b[i]]=!0;for(i=0,n=a.length;n>i;i++)inB[a[i]]||result.push(a[i]);return result},map={},applyChanges=function(newTokens,oldTokens){var i,n,el,token,replacedTokens={},removedTokens=subtractAsSets(oldTokens,newTokens);for(i=0,n=removedTokens.length;n>i;i++){var removedToken=removedTokens[i];el=map[removedToken],delete map[removedToken];var newToken=tokenFn(el);newToken===removedToken?self.onRemoved(el):(replacedTokens[newToken]=removedToken,self.onChanged(el))}var addedTokens=subtractAsSets(newTokens,oldTokens);for(i=0,n=addedTokens.length;n>i;i++)token=addedTokens[i],el=map[token],replacedTokens[token]||self.onAdded(el)};return self={subscribe:function(scope,onArrayChanged){scope.$watch(getTokens,function(newTokens,oldTokens){var notify=!(onArrayChanged&&onArrayChanged(newTokens,oldTokens)===!1);notify&&applyChanges(newTokens,oldTokens)},!0)},onAdded:angular.noop,onChanged:angular.noop,onRemoved:angular.noop}},this.getFullCalendarConfig=function(calendarSettings,uiCalendarConfig){var config={};return angular.extend(config,uiCalendarConfig),angular.extend(config,calendarSettings),angular.forEach(config,function(value,key){"function"==typeof value&&(config[key]=wrapFunctionWithScopeApply(config[key]))}),config},this.getLocaleConfig=function(fullCalendarConfig){if(!fullCalendarConfig.lang||fullCalendarConfig.useNgLocale){var tValues=function(data){var r,k;r=[];for(k in data)r[k]=data[k];return r},dtf=$locale.DATETIME_FORMATS;return{monthNames:tValues(dtf.MONTH),monthNamesShort:tValues(dtf.SHORTMONTH),dayNames:tValues(dtf.DAY),dayNamesShort:tValues(dtf.SHORTDAY)}}return{}}}]).directive("uiCalendar",["uiCalendarConfig",function(uiCalendarConfig){return{restrict:"A",scope:{eventSources:"=ngModel",calendarWatchEvent:"&"},controller:"uiCalendarCtrl",link:function(scope,elm,attrs,controller){function getOptions(){var fullCalendarConfig,calendarSettings=attrs.uiCalendar?scope.$parent.$eval(attrs.uiCalendar):{};fullCalendarConfig=controller.getFullCalendarConfig(calendarSettings,uiCalendarConfig);var localeFullCalendarConfig=controller.getLocaleConfig(fullCalendarConfig);angular.extend(localeFullCalendarConfig,fullCalendarConfig),options={eventSources:sources},angular.extend(options,localeFullCalendarConfig),options.calendars=null;var options2={};for(var o in options)"eventSources"!==o&&(options2[o]=options[o]);return JSON.stringify(options2)}var calendar,sources=scope.eventSources,sourcesChanged=!1,eventSourcesWatcher=controller.changeWatcher(sources,controller.sourceFingerprint),eventsWatcher=controller.changeWatcher(controller.allEvents,controller.eventFingerprint),options=null;scope.destroyCalendar=function(){calendar&&calendar.fullCalendar&&calendar.fullCalendar("destroy"),calendar=attrs.calendar?uiCalendarConfig.calendars[attrs.calendar]=$(elm).html(""):$(elm).html("")},scope.initCalendar=function(){calendar||(calendar=angular.element(elm).html("")),calendar.fullCalendar(options),attrs.calendar&&(uiCalendarConfig.calendars[attrs.calendar]=calendar)},scope.$on("$destroy",function(){scope.destroyCalendar()}),eventSourcesWatcher.onAdded=function(source){calendar&&calendar.fullCalendar&&(calendar.fullCalendar(options),attrs.calendar&&(uiCalendarConfig.calendars[attrs.calendar]=calendar),calendar.fullCalendar("addEventSource",source),sourcesChanged=!0)},eventSourcesWatcher.onRemoved=function(source){calendar&&calendar.fullCalendar&&(calendar.fullCalendar("removeEventSource",source),sourcesChanged=!0)},eventSourcesWatcher.onChanged=function(){calendar&&calendar.fullCalendar&&(calendar.fullCalendar("refetchEvents"),sourcesChanged=!0)},eventsWatcher.onAdded=function(event){calendar&&calendar.fullCalendar&&calendar.fullCalendar("renderEvent",event,event.stick?!0:!1)},eventsWatcher.onRemoved=function(event){calendar&&calendar.fullCalendar&&calendar.fullCalendar("removeEvents",event._id)},eventsWatcher.onChanged=function(event){if(calendar&&calendar.fullCalendar)for(var clientEvents=calendar.fullCalendar("clientEvents",event._id),i=0;i<clientEvents.length;i++){var clientEvent=clientEvents[i];clientEvent=angular.extend(clientEvent,event),calendar.fullCalendar("updateEvent",clientEvent)}},eventSourcesWatcher.subscribe(scope),eventsWatcher.subscribe(scope,function(){return sourcesChanged===!0?(sourcesChanged=!1,!1):void 0}),scope.$watch(getOptions,function(newValue,oldValue){newValue!==oldValue?(scope.destroyCalendar(),scope.initCalendar()):newValue&&angular.isUndefined(calendar)&&scope.initCalendar()})}}}]),angular.module("myApp.templates",[]).run(["$templateCache",function($templateCache){$templateCache.put("views/adduser.html",'<div class=page-adduser><header><center><h2>Add New User</h2></center></header><main class=body-addUser><form class=form-horizontal ng-submit=addUser()><div class=form-group><label class="col-lg-2 control-label">Firstname</label><div class=col-lg-10><input class="form-control form-input" name=firstName placeholder=Firstname ng-model="firstName"></div></div><div class=form-group><label class="col-lg-2 control-label">Lastname</label><div class=col-lg-10><input class="form-control form-input" name=lastName placeholder=Lastname ng-model="lastName"></div></div><div class=form-group><label class="col-lg-2 control-label">Gender</label><div class=col-lg-10><select class="form-control form-input" name=gender ng-model=gender ng-init="gender=\'0\'"><option value=0>Male</option><option value=1>Female</option></select></div></div><div class=form-group><label class="col-lg-2 control-label">Email</label><div class=col-lg-10><input class="form-control form-input" name=email placeholder=Email ng-model="email"></div></div><div class=form-group><div class="col-lg-offset-2 col-lg-10"><button type=submit class="btn btn-info">Submit</button> <button type=submit class="btn btn-warning">Reset</button></div></div></form></main></div>'),$templateCache.put("views/calendar.html",'<div ui-calendar=uiConfig.calendar class="span8 calendar" ng-model=eventSources></div>'),$templateCache.put("views/drive.html","<div><h3 class=page-header>Drive</h3><angular-filemanager></angular-filemanager></div>"),$templateCache.put("views/file.html",'<div><input type=file nv-file-select uploader="uploader"><br><ul><li ng-repeat="item in uploader.queue">Name: <span ng-bind=item.file.name></span><br><button ng-click=item.upload()>upload</button></li></ul></div>'),$templateCache.put("views/homepage.html","<div><center><h1>Welcome to HOMEPAGE.</h1></center></div>"),$templateCache.put("views/map.html","<div id=page-map><h3 class=page-header>Locator</h3><ui-gmap-google-map center=map.center zoom=map.zoom draggable=true options=options bounds=map.bounds><ui-gmap-markers models=markers coords=\"'coords'\" options=\"'options'\"></ui-gmap-markers></ui-gmap-google-map></div>"),$templateCache.put("views/userlist.html",'<div class=page-users ng-init=init()><header><center><h2>User List</h2></center></header><main class=body-user><div class=row><div class=col-md-3><input class="form-control input-block" placeholder="Search Users" ng-model="filterText"></div></div><div class="table-responsive table-user"><table class="table table-hover"><thead><tr><th>Mobile Number</th><th>Date of Birth</th><th>Gender</th><th>Created Dated</th></tr></thead><tbody ng-repeat="user in users | filter:filterText"><tr><td>{{user.mobileNo}}</td><td>{{user.dateOfBirth}}</td><td>{{user.gender == 1 ? \'Male\' : \'Female\'}}</td><td>{{user.createDate}}</td></tr></tbody></table></div></main></div>')}]);